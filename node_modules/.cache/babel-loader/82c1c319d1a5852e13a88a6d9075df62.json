{"ast":null,"code":"import _objectSpread from\"C:/Users/avocado-dev/Desktop/Programming/gospelchurch-FE-React/gospelchurch-FE-React-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/avocado-dev/Desktop/Programming/gospelchurch-FE-React/gospelchurch-FE-React-main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/avocado-dev/Desktop/Programming/gospelchurch-FE-React/gospelchurch-FE-React-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/avocado-dev/Desktop/Programming/gospelchurch-FE-React/gospelchurch-FE-React-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useSelector}from\"react-redux\";import{useNavigate,useParams}from\"react-router-dom\";import{useCallback,useEffect,useState}from\"react\";import ImageUploader from\"../../components/ImageUploader\";import api from\"../../utils/api\";import TextArea from\"../../components/TextArea\";import{Button}from\"@mui/material\";import\"../add-board/addBoard.scss\";import axios from\"axios\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditBoard=function EditBoard(){var token=useSelector(function(state){return state.Auth.token;});var navigate=useNavigate();// URI 파라미터 가져오기\nvar _useParams=useParams(),board_id=_useParams.board_id;// 게시판 제목, 내용, 사진\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),content=_useState4[0],setContent=_useState4[1];var _useState5=useState({image_file:\"\",preview_URL:\"image/default_image.png\"}),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];// 사용자가 직전에 등록한 게시물의 상태를 그대로 보여주기 위해\n// 컴포넌트가 마운트되고 URI 파라미터에 해당하는 board를 가져와서\n// title, content, image의 상태를 바꿔줌\nuseEffect(function(){var getBoard=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/board/\".concat(board_id));case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getBoard(){return _ref.apply(this,arguments);};}();getBoard().then(function(result){setTitle(result.title);setContent(result.content);// 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n// 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\nsetImage(_objectSpread(_objectSpread({},image),{},{preview_URL:\"/api/image/view/\".concat(board_id)}));});},[]);var canSubmit=useCallback(function(){return content!==\"\"&&title!==\"\";},[image,title,content]);var handleSubmit=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var formData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;formData=new FormData();formData.append(\"title\",title);formData.append(\"content\",content);// 이미지를 선택했을 때만 formdata에 넣음\nformData.append(\"file\",image.image_file);// 수정할 땐 board_id를 보내자\nformData.append(\"id\",board_id);_context2.next=8;return api.put(\"/api/board\",formData);case 8:window.alert(\"😎수정이 완료되었습니다😎\");// 이전 페이지로 돌아가기\nwindow.location.href=\"/board/\".concat(board_id);_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](0);// 서버에서 받은 에러 메시지 출력\ntoast.error(\"오류발생! 이모지를 사용하면 오류가 발생할 수 있습니다\"+\"😭\",{position:\"top-center\"});case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[0,12]]);})),[canSubmit]);return/*#__PURE__*/_jsxs(\"div\",{className:\"addBoard-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"addBoard-header\",children:\"\\uAC8C\\uC2DC\\uBB3C \\uC218\\uC815\\uD558\\uAE30 \\uD83D\\uDD8A\\uFE0F\"}),/*#__PURE__*/_jsx(\"div\",{className:\"submitButton\",children:canSubmit()?/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,className:\"success-button\",variant:\"outlined\",children:\"\\uC218\\uC815\\uD558\\uAE30\\uD83D\\uDE03\"}):/*#__PURE__*/_jsx(Button,{className:\"disable-button\",variant:\"outlined\",size:\"large\",children:\"\\uC81C\\uBAA9\\uACFC \\uB0B4\\uC6A9\\uC744 \\uBAA8\\uB450 \\uC785\\uB825\\uD558\\uC138\\uC694\\uD83D\\uDE2D\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"addBoard-body\",children:[/*#__PURE__*/_jsx(ImageUploader,{setImage:setImage,preview_URL:image.preview_URL}),/*#__PURE__*/_jsx(TextArea,{setTitle:setTitle,setContent:setContent,title:title,content:content})]})]});};export default EditBoard;","map":{"version":3,"names":["useSelector","useNavigate","useParams","useCallback","useEffect","useState","ImageUploader","api","TextArea","Button","axios","toast","EditBoard","token","state","Auth","navigate","board_id","title","setTitle","content","setContent","image_file","preview_URL","image","setImage","getBoard","get","data","then","result","canSubmit","handleSubmit","formData","FormData","append","put","window","alert","location","href","error","position"],"sources":["C:/Users/avocado-dev/Desktop/Programming/gospelchurch-FE-React/gospelchurch-FE-React-main/src/pages/edit-board/EditBoard.js"],"sourcesContent":["import {useSelector} from \"react-redux\";\nimport {useNavigate, useParams} from \"react-router-dom\";\nimport {useCallback, useEffect, useState} from \"react\";\nimport ImageUploader from \"../../components/ImageUploader\";\nimport api from \"../../utils/api\";\nimport TextArea from \"../../components/TextArea\";\nimport {Button} from \"@mui/material\";\nimport \"../add-board/addBoard.scss\";\nimport axios from \"axios\";\nimport {toast} from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\n\nconst EditBoard = () => {\n  const token = useSelector(state => state.Auth.token);\n  const navigate = useNavigate();\n  // URI 파라미터 가져오기\n  const {board_id} = useParams();\n  // 게시판 제목, 내용, 사진\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState({\n    image_file: \"\",\n    preview_URL: \"image/default_image.png\",\n  });\n\n  // 사용자가 직전에 등록한 게시물의 상태를 그대로 보여주기 위해\n  // 컴포넌트가 마운트되고 URI 파라미터에 해당하는 board를 가져와서\n  // title, content, image의 상태를 바꿔줌\n  useEffect(() => {\n    const getBoard = async () => {\n      const {data} = await axios.get(`/api/board/${board_id}`);\n      return data;\n    }\n    getBoard().then((result) => {\n      setTitle(result.title);\n      setContent(result.content);\n      // 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n      // 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\n      setImage({...image, preview_URL: `/api/image/view/${board_id}`})\n    });\n  }, [])\n\n  const canSubmit = useCallback(() => {\n    return content !== \"\" && title !== \"\";\n  }, [image, title, content]);\n\n  const handleSubmit = useCallback(async () => {\n    try {\n      const formData = new FormData();\n      formData.append(\"title\", title);\n      formData.append(\"content\", content);\n      // 이미지를 선택했을 때만 formdata에 넣음\n      formData.append(\"file\", image.image_file);\n      // 수정할 땐 board_id를 보내자\n      formData.append(\"id\", board_id);\n      await api.put(\"/api/board\", formData);\n      window.alert(\"😎수정이 완료되었습니다😎\");\n      // 이전 페이지로 돌아가기\n      window.location.href = `/board/${board_id}`;\n    } catch (e) {\n      // 서버에서 받은 에러 메시지 출력\n      toast.error(\"오류발생! 이모지를 사용하면 오류가 발생할 수 있습니다\" + \"😭\", {\n        position: \"top-center\",\n      });\n    }\n\n  }, [canSubmit]);\n\n  return (\n    <div className=\"addBoard-wrapper\">\n      <div className=\"addBoard-header\">\n        게시물 수정하기 🖊️\n      </div>\n      <div className=\"submitButton\">\n        {canSubmit() ? (\n          <Button\n            onClick={handleSubmit}\n            className=\"success-button\"\n            variant=\"outlined\"\n          >\n            수정하기😃\n          </Button>\n        ) : (\n          <Button\n            className=\"disable-button\"\n            variant=\"outlined\"\n            size=\"large\"\n          >\n            제목과 내용을 모두 입력하세요😭\n          </Button>\n        )}\n      </div>\n      <div className=\"addBoard-body\">\n        <ImageUploader setImage={setImage} preview_URL={image.preview_URL}/>\n        <TextArea setTitle={setTitle} setContent={setContent} title={title} content={content}/>\n      </div>\n    </div>\n  );\n}\n\nexport default EditBoard;"],"mappings":"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"},"metadata":{},"sourceType":"module"}