{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\avocado-dev\\\\Desktop\\\\Programming\\\\Board-FE-React-main\\\\Board-FE-React-main\\\\src\\\\pages\\\\edit-board\\\\EditBoard.js\",\n    _s = $RefreshSig$();\n\nimport { useSelector } from \"react-redux\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport ImageUploader from \"../../components/ImageUploader\";\nimport api from \"../../utils/api\";\nimport TextArea from \"../../components/TextArea\";\nimport { Button } from \"@mui/material\";\nimport \"../add-board/addBoard.scss\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditBoard = () => {\n  _s();\n\n  const token = useSelector(state => state.Auth.token);\n  const navigate = useNavigate(); // URI 파라미터 가져오기\n\n  const {\n    board_id\n  } = useParams(); // 게시판 제목, 내용, 사진\n\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState({\n    image_file: \"\",\n    preview_URL: \"image/default_image.png\"\n  }); // 사용자가 직전에 등록한 게시물의 상태를 그대로 보여주기 위해\n  // 컴포넌트가 마운트되고 URI 파라미터에 해당하는 board를 가져와서\n  // title, content, image의 상태를 바꿔줌\n\n  useEffect(() => {\n    const getBoard = async () => {\n      const {\n        data\n      } = await axios.get(`/api/board/${board_id}`);\n      return data;\n    };\n\n    getBoard().then(result => {\n      setTitle(result.title);\n      setContent(result.content); // 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n      // 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\n\n      setImage({ ...image,\n        preview_URL: `/api/image/view/${board_id}`\n      });\n    });\n  }, []);\n  const canSubmit = useCallback(() => {\n    return content !== \"\" && title !== \"\";\n  }, [image, title, content]);\n  const handleSubmit = useCallback(async () => {\n    try {\n      const formData = new FormData();\n      formData.append(\"title\", title);\n      formData.append(\"content\", content); // 이미지를 선택했을 때만 formdata에 넣음\n\n      formData.append(\"file\", image.image_file); // 수정할 땐 board_id를 보내자\n\n      formData.append(\"id\", board_id);\n      await api.put(\"/api/board\", formData);\n      window.alert(\"😎수정이 완료되었습니다😎\"); // 이전 페이지로 돌아가기\n\n      window.location.href = `/board/${board_id}`;\n    } catch (e) {\n      // 서버에서 받은 에러 메시지 출력\n      toast.error(\"오류발생! 이모지를 사용하면 오류가 발생할 수 있습니다\" + \"😭\", {\n        position: \"top-center\"\n      });\n    }\n  }, [canSubmit]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"addBoard-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addBoard-header\",\n      children: \"\\uAC8C\\uC2DC\\uBB3C \\uC218\\uC815\\uD558\\uAE30 \\uD83D\\uDD8A\\uFE0F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"submitButton\",\n      children: canSubmit() ? /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleSubmit,\n        className: \"success-button\",\n        variant: \"outlined\",\n        children: \"\\uC218\\uC815\\uD558\\uAE30\\uD83D\\uDE03\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Button, {\n        className: \"disable-button\",\n        variant: \"outlined\",\n        size: \"large\",\n        children: \"\\uC81C\\uBAA9\\uACFC \\uB0B4\\uC6A9\\uC744 \\uBAA8\\uB450 \\uC785\\uB825\\uD558\\uC138\\uC694\\uD83D\\uDE2D\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"addBoard-body\",\n      children: [/*#__PURE__*/_jsxDEV(ImageUploader, {\n        setImage: setImage,\n        preview_URL: image.preview_URL\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextArea, {\n        setTitle: setTitle,\n        setContent: setContent,\n        title: title,\n        content: content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n\n_s(EditBoard, \"LozraeP7LXCY28W8FJZh38I1cKE=\", false, function () {\n  return [useSelector, useNavigate, useParams];\n});\n\n_c = EditBoard;\nexport default EditBoard;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditBoard\");","map":{"version":3,"names":["useSelector","useNavigate","useParams","useCallback","useEffect","useState","ImageUploader","api","TextArea","Button","axios","toast","EditBoard","token","state","Auth","navigate","board_id","title","setTitle","content","setContent","image","setImage","image_file","preview_URL","getBoard","data","get","then","result","canSubmit","handleSubmit","formData","FormData","append","put","window","alert","location","href","e","error","position"],"sources":["C:/Users/avocado-dev/Desktop/Programming/Board-FE-React-main/Board-FE-React-main/src/pages/edit-board/EditBoard.js"],"sourcesContent":["import {useSelector} from \"react-redux\";\nimport {useNavigate, useParams} from \"react-router-dom\";\nimport {useCallback, useEffect, useState} from \"react\";\nimport ImageUploader from \"../../components/ImageUploader\";\nimport api from \"../../utils/api\";\nimport TextArea from \"../../components/TextArea\";\nimport {Button} from \"@mui/material\";\nimport \"../add-board/addBoard.scss\";\nimport axios from \"axios\";\nimport {toast} from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n\n\nconst EditBoard = () => {\n  const token = useSelector(state => state.Auth.token);\n  const navigate = useNavigate();\n  // URI 파라미터 가져오기\n  const {board_id} = useParams();\n  // 게시판 제목, 내용, 사진\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState({\n    image_file: \"\",\n    preview_URL: \"image/default_image.png\",\n  });\n\n  // 사용자가 직전에 등록한 게시물의 상태를 그대로 보여주기 위해\n  // 컴포넌트가 마운트되고 URI 파라미터에 해당하는 board를 가져와서\n  // title, content, image의 상태를 바꿔줌\n  useEffect(() => {\n    const getBoard = async () => {\n      const {data} = await axios.get(`/api/board/${board_id}`);\n      return data;\n    }\n    getBoard().then((result) => {\n      setTitle(result.title);\n      setContent(result.content);\n      // 이미지는 파일을 불러올 필요가 없이 미리보기 url만 가져온다.\n      // 이미지를 선택하지 않고 올리면 db에 저장되어 있는 이미지를 그대로 사용!\n      setImage({...image, preview_URL: `/api/image/view/${board_id}`})\n    });\n  }, [])\n\n  const canSubmit = useCallback(() => {\n    return content !== \"\" && title !== \"\";\n  }, [image, title, content]);\n\n  const handleSubmit = useCallback(async () => {\n    try {\n      const formData = new FormData();\n      formData.append(\"title\", title);\n      formData.append(\"content\", content);\n      // 이미지를 선택했을 때만 formdata에 넣음\n      formData.append(\"file\", image.image_file);\n      // 수정할 땐 board_id를 보내자\n      formData.append(\"id\", board_id);\n      await api.put(\"/api/board\", formData);\n      window.alert(\"😎수정이 완료되었습니다😎\");\n      // 이전 페이지로 돌아가기\n      window.location.href = `/board/${board_id}`;\n    } catch (e) {\n      // 서버에서 받은 에러 메시지 출력\n      toast.error(\"오류발생! 이모지를 사용하면 오류가 발생할 수 있습니다\" + \"😭\", {\n        position: \"top-center\",\n      });\n    }\n\n  }, [canSubmit]);\n\n  return (\n    <div className=\"addBoard-wrapper\">\n      <div className=\"addBoard-header\">\n        게시물 수정하기 🖊️\n      </div>\n      <div className=\"submitButton\">\n        {canSubmit() ? (\n          <Button\n            onClick={handleSubmit}\n            className=\"success-button\"\n            variant=\"outlined\"\n          >\n            수정하기😃\n          </Button>\n        ) : (\n          <Button\n            className=\"disable-button\"\n            variant=\"outlined\"\n            size=\"large\"\n          >\n            제목과 내용을 모두 입력하세요😭\n          </Button>\n        )}\n      </div>\n      <div className=\"addBoard-body\">\n        <ImageUploader setImage={setImage} preview_URL={image.preview_URL}/>\n        <TextArea setTitle={setTitle} setContent={setContent} title={title} content={content}/>\n      </div>\n    </div>\n  );\n}\n\nexport default EditBoard;"],"mappings":"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"},"metadata":{},"sourceType":"module"}